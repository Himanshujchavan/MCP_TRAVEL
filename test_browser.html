<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Server Tester</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        .container { margin-bottom: 20px; }
        .result { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .success { border-left: 5px solid #4CAF50; }
        .error { border-left: 5px solid #f44336; }
        button { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #005a8b; }
        textarea { width: 100%; height: 100px; font-family: monospace; }
        .loading { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <h1>ğŸš€ AI Trip Planner MCP Server Tester</h1>
    <p><strong>Server URL:</strong> https://mcp-travel.onrender.com/mcp/</p>
    
    <div class="container">
        <h3>Quick Tests</h3>
        <button onclick="testToolsList()">ğŸ“‹ List All Tools</button>
        <button onclick="testHealthCheck()">ğŸ¥ Health Check</button>
        <button onclick="testWeather()">ğŸŒ¤ï¸ Test Weather</button>
        <button onclick="testTripPlanning()">ğŸ—ºï¸ Test Trip Planning</button>
    </div>

    <div class="container">
        <h3>Custom Tool Test</h3>
        <input type="text" id="toolName" placeholder="Tool name (e.g., get_weather)" style="width: 200px; padding: 5px;">
        <br><br>
        <textarea id="toolArgs" placeholder='{"location": "Paris", "days": 3}'></textarea>
        <br>
        <button onclick="testCustomTool()">ğŸ”§ Test Custom Tool</button>
    </div>

    <div id="results"></div>

    <script>
        const MCP_URL = 'https://mcp-travel.onrender.com/mcp';
        const AUTH_TOKEN = 'oAGVDZtqPIqnhSoyJiPrBTsfKeCN_gsUmrqZZRxeYwE';

        function addResult(title, content, isSuccess = true) {
            const resultsDiv = document.getElementById('results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${isSuccess ? 'success' : 'error'}`;
            resultDiv.innerHTML = `<h4>${title}</h4><pre>${content}</pre>`;
            resultsDiv.insertBefore(resultDiv, resultsDiv.firstChild);
        }

        function addLoading(title) {
            addResult(title, 'Loading...', true);
        }

        async function makeRequest(endpoint, data = {}) {
            try {
                const response = await fetch(`${MCP_URL}${endpoint}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${AUTH_TOKEN}`
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                return { success: response.ok, data: result, status: response.status };
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        async function testToolsList() {
            addLoading('ğŸ“‹ Testing Tools List');
            const result = await makeRequest('/tools/list');
            
            if (result.success) {
                const tools = result.data.tools || [];
                let content = `Found ${tools.length} tools:\n\n`;
                tools.forEach((tool, i) => {
                    content += `${i + 1}. ${tool.name}\n`;
                });
                addResult('ğŸ“‹ Tools List - SUCCESS', content);
            } else {
                addResult('ğŸ“‹ Tools List - FAILED', JSON.stringify(result, null, 2), false);
            }
        }

        async function testHealthCheck() {
            addLoading('ğŸ¥ Testing Health Check');
            const result = await makeRequest('/tools/call', {
                name: 'health_check',
                arguments: {}
            });
            
            if (result.success) {
                addResult('ğŸ¥ Health Check - SUCCESS', JSON.stringify(result.data, null, 2));
            } else {
                addResult('ğŸ¥ Health Check - FAILED', JSON.stringify(result, null, 2), false);
            }
        }

        async function testWeather() {
            addLoading('ğŸŒ¤ï¸ Testing Weather Tool');
            const result = await makeRequest('/tools/call', {
                name: 'get_weather',
                arguments: {
                    location: 'London',
                    days: 3
                }
            });
            
            if (result.success) {
                addResult('ğŸŒ¤ï¸ Weather Tool - SUCCESS', JSON.stringify(result.data, null, 2));
            } else {
                addResult('ğŸŒ¤ï¸ Weather Tool - FAILED', JSON.stringify(result, null, 2), false);
            }
        }

        async function testTripPlanning() {
            addLoading('ğŸ—ºï¸ Testing Trip Planning Tool');
            const result = await makeRequest('/tools/call', {
                name: 'plan_trip',
                arguments: {
                    origin: 'New York',
                    destination: 'Paris',
                    start_date: '2024-06-01',
                    end_date: '2024-06-05',
                    adults: 2,
                    budget: 3000,
                    activities: ['museums', 'food']
                }
            });
            
            if (result.success) {
                addResult('ğŸ—ºï¸ Trip Planning Tool - SUCCESS', JSON.stringify(result.data, null, 2));
            } else {
                addResult('ğŸ—ºï¸ Trip Planning Tool - FAILED', JSON.stringify(result, null, 2), false);
            }
        }

        async function testCustomTool() {
            const toolName = document.getElementById('toolName').value;
            const toolArgsText = document.getElementById('toolArgs').value;
            
            if (!toolName) {
                alert('Please enter a tool name');
                return;
            }

            let toolArgs;
            try {
                toolArgs = toolArgsText ? JSON.parse(toolArgsText) : {};
            } catch (e) {
                alert('Invalid JSON in arguments');
                return;
            }

            addLoading(`ğŸ”§ Testing Custom Tool: ${toolName}`);
            const result = await makeRequest('/tools/call', {
                name: toolName,
                arguments: toolArgs
            });
            
            if (result.success) {
                addResult(`ğŸ”§ Custom Tool (${toolName}) - SUCCESS`, JSON.stringify(result.data, null, 2));
            } else {
                addResult(`ğŸ”§ Custom Tool (${toolName}) - FAILED`, JSON.stringify(result, null, 2), false);
            }
        }

        // Auto-run tools list on page load
        window.onload = function() {
            testToolsList();
        };
    </script>
</body>
</html>
